<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>官方文档地址 | 十月</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/docs/images/7.png">
    <meta name="description" content="vuepress博客">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="full-screen" content="true">
    <meta name="x5-fullscreen" content="true">
    <meta name="360-fullscreen" content="true">
    <link rel="preload" href="/docs/assets/css/0.styles.1ad37322.css" as="style"><link rel="preload" href="/docs/assets/js/app.ca99be60.js" as="script"><link rel="preload" href="/docs/assets/js/2.f90869d3.js" as="script"><link rel="preload" href="/docs/assets/js/22.9270e206.js" as="script"><link rel="prefetch" href="/docs/assets/js/10.4e260648.js"><link rel="prefetch" href="/docs/assets/js/11.c7faf0dc.js"><link rel="prefetch" href="/docs/assets/js/12.4d2c3fa3.js"><link rel="prefetch" href="/docs/assets/js/13.0bca2749.js"><link rel="prefetch" href="/docs/assets/js/14.dd92793f.js"><link rel="prefetch" href="/docs/assets/js/15.eeac8df6.js"><link rel="prefetch" href="/docs/assets/js/16.77c2d47d.js"><link rel="prefetch" href="/docs/assets/js/17.6c52002a.js"><link rel="prefetch" href="/docs/assets/js/18.c007769d.js"><link rel="prefetch" href="/docs/assets/js/19.5b702adb.js"><link rel="prefetch" href="/docs/assets/js/20.8b01c1c8.js"><link rel="prefetch" href="/docs/assets/js/21.f30b63cd.js"><link rel="prefetch" href="/docs/assets/js/23.ea1e1991.js"><link rel="prefetch" href="/docs/assets/js/24.5f38cba3.js"><link rel="prefetch" href="/docs/assets/js/25.6c2aa877.js"><link rel="prefetch" href="/docs/assets/js/26.7f92cc24.js"><link rel="prefetch" href="/docs/assets/js/27.cc2178c9.js"><link rel="prefetch" href="/docs/assets/js/28.0ee493cf.js"><link rel="prefetch" href="/docs/assets/js/29.338f737e.js"><link rel="prefetch" href="/docs/assets/js/3.edb5e83a.js"><link rel="prefetch" href="/docs/assets/js/30.4fb62da0.js"><link rel="prefetch" href="/docs/assets/js/31.a6505a92.js"><link rel="prefetch" href="/docs/assets/js/32.98248ad6.js"><link rel="prefetch" href="/docs/assets/js/33.7257a28d.js"><link rel="prefetch" href="/docs/assets/js/34.64629f75.js"><link rel="prefetch" href="/docs/assets/js/35.e7242380.js"><link rel="prefetch" href="/docs/assets/js/36.3bc1c98b.js"><link rel="prefetch" href="/docs/assets/js/37.912b0fe3.js"><link rel="prefetch" href="/docs/assets/js/38.c532bc23.js"><link rel="prefetch" href="/docs/assets/js/4.af1ff500.js"><link rel="prefetch" href="/docs/assets/js/5.dc2b2112.js"><link rel="prefetch" href="/docs/assets/js/6.0e82c544.js"><link rel="prefetch" href="/docs/assets/js/7.30be3a2a.js"><link rel="prefetch" href="/docs/assets/js/8.d653075e.js"><link rel="prefetch" href="/docs/assets/js/9.4e806e1c.js">
    <link rel="stylesheet" href="/docs/assets/css/0.styles.1ad37322.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/" class="home-link router-link-active"><img src="/docs/images/7.png" alt="十月" class="logo"> <span class="site-name can-hide">十月</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/blog/" class="nav-link">
  技术博客
</a></div><div class="nav-item"><a href="/docs/JavaScript/" class="nav-link">
  Js
</a></div><div class="nav-item"><a href="/docs/css/" class="nav-link">
  html+css
</a></div><div class="nav-item"><a href="/docs/Vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/docs/React/" class="nav-link router-link-exact-active router-link-active">
  React
</a></div><div class="nav-item"><a href="/docs/node/" class="nav-link">
  node
</a></div><div class="nav-item"><a href="/docs/wx/" class="nav-link">
  wx
</a></div><div class="nav-item"><a href="/docs/http/" class="nav-link">
  网络
</a></div><div class="nav-item"><a href="/docs/myComponents/" class="nav-link">
  封装组件
</a></div><div class="nav-item"><a href="/docs/utils/" class="nav-link">
  工具
</a></div><div class="nav-item"><a href="https://github.com/lovebabyqi/Components" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/blog/" class="nav-link">
  技术博客
</a></div><div class="nav-item"><a href="/docs/JavaScript/" class="nav-link">
  Js
</a></div><div class="nav-item"><a href="/docs/css/" class="nav-link">
  html+css
</a></div><div class="nav-item"><a href="/docs/Vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/docs/React/" class="nav-link router-link-exact-active router-link-active">
  React
</a></div><div class="nav-item"><a href="/docs/node/" class="nav-link">
  node
</a></div><div class="nav-item"><a href="/docs/wx/" class="nav-link">
  wx
</a></div><div class="nav-item"><a href="/docs/http/" class="nav-link">
  网络
</a></div><div class="nav-item"><a href="/docs/myComponents/" class="nav-link">
  封装组件
</a></div><div class="nav-item"><a href="/docs/utils/" class="nav-link">
  工具
</a></div><div class="nav-item"><a href="https://github.com/lovebabyqi/Components" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/docs/React/" class="active sidebar-link">官方文档地址</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#官方文档地址" class="sidebar-link">官方文档地址</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_1-react虚拟dom" class="sidebar-link">1. React虚拟DOM</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#_1-1-虚拟dom对比真实dom" class="sidebar-link">1.1 虚拟DOM对比真实DOM</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_1-2-key值" class="sidebar-link">1.2 key值</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/React/#_2-jsx语法" class="sidebar-link">2.jsx语法</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_3-react组件" class="sidebar-link">3. React组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#_3-1函数组件" class="sidebar-link">3.1函数组件</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_3-2-类组件" class="sidebar-link">3.2 类组件</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/React/#_4-生命周期函数" class="sidebar-link">4. 生命周期函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#_4-1-挂载阶段" class="sidebar-link">4.1 挂载阶段</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_4-2-更新阶段" class="sidebar-link">4.2 更新阶段</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_4-3-组件销毁" class="sidebar-link">4.3 组件销毁</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_4-4-render函数" class="sidebar-link">4.4 render函数</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/React/#_5-setstate" class="sidebar-link">5.setState</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#_5-1-setstate（）第一个参数" class="sidebar-link">5.1 setState（）第一个参数</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_5-2-setstate同步异步" class="sidebar-link">5.2 setState同步异步</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_5-3-setstate第二个参数" class="sidebar-link">5.3 setState第二个参数</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/React/#_6-组建通信传递数据" class="sidebar-link">6. 组建通信传递数据</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#_6-1-父子组件通信" class="sidebar-link">6.1 父子组件通信</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_6-2-任意组建通信" class="sidebar-link">6.2 任意组建通信</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/React/#_7-受控表单，非受控表单" class="sidebar-link">7. 受控表单，非受控表单</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#_7-1-实时收集数据，受控表单" class="sidebar-link">7.1 实时收集数据，受控表单</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_7-2-需要使用时再取数据，非受控" class="sidebar-link">7.2 需要使用时再取数据，非受控</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/React/#_8-react条件渲染" class="sidebar-link">8. react条件渲染</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#三目" class="sidebar-link">三目</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/React/#_9-react列表渲染" class="sidebar-link">9. react列表渲染</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_10-react-router-dom路由" class="sidebar-link">10. React-router-dom路由</a></li><li class="sidebar-sub-header"><a href="/docs/React/#react前台路由" class="sidebar-link">React前台路由</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#_10-1-react-router-dom包" class="sidebar-link">10.1 react-router-dom包</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_10-2-使用" class="sidebar-link">10.2 使用</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_10-3-归纳" class="sidebar-link">10.3 归纳</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_10-4-编程式导航" class="sidebar-link">10.4 编程式导航</a></li><li class="sidebar-sub-header"><a href="/docs/React/#代码分割-基于路由分割" class="sidebar-link">代码分割,基于路由分割</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/React/#_11-redux仓库" class="sidebar-link">11. redux仓库</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#_11-1-redux三个基本原则" class="sidebar-link">11.1 redux三个基本原则</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_11-2-react-redux" class="sidebar-link">11.2 react-redux</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/React/#_12-高阶组件概念" class="sidebar-link">12. 高阶组件概念</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_13-reacthook函数" class="sidebar-link">13. reacthook函数</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#概念" class="sidebar-link">概念</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_13-1-usestate" class="sidebar-link">13.1 useState</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_13-2-useeffect" class="sidebar-link">13.2 useEffect</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_13-3-useref" class="sidebar-link">13.3 useRef</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_13-4-自定义hook" class="sidebar-link">13.4 自定义hook</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_13-5-usereducer" class="sidebar-link">13.5 useReducer</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_13-6-usecontext" class="sidebar-link">13.6 useContext</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_13-7-usecallback" class="sidebar-link">13.7 useCallback</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/React/#_14-react引用本地图片问题" class="sidebar-link">14. react引用本地图片问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#方法一：" class="sidebar-link">方法一：</a></li><li class="sidebar-sub-header"><a href="/docs/React/#方法二：" class="sidebar-link">方法二：</a></li><li class="sidebar-sub-header"><a href="/docs/React/#方法三：-不推荐使用" class="sidebar-link">方法三：(不推荐使用)</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/React/#_15-createreactapp脚手架" class="sidebar-link">15. CreateReactApp脚手架</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#安装依赖-4" class="sidebar-link">安装依赖</a></li></ul></li><li class="sidebar-sub-header"><a href="/docs/React/#_16-代码分割，异步组件" class="sidebar-link">16. 代码分割，异步组件</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/React/#_16-1-react-lazy" class="sidebar-link">16.1 React.lazy</a></li><li class="sidebar-sub-header"><a href="/docs/React/#_16-2-loading组件封装" class="sidebar-link">16.2 loading组件封装</a></li></ul></li></ul></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="官方文档地址"><a href="#官方文档地址" class="header-anchor">#</a> <a href="https://react.docschina.org/docs/getting-started.html" target="_blank" rel="noopener noreferrer">官方文档地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h2> <h1 id="react"><a href="#react" class="header-anchor">#</a> React</h1> <h2 id="_1-react虚拟dom"><a href="#_1-react虚拟dom" class="header-anchor">#</a> 1. React虚拟DOM</h2> <p>1.如何创建虚拟dom ，React.createElement(节点的类型,节点的属性,节点的内容)。</p> <p>2..虚拟dom和真实dom的区别，虚拟dom是一个对象 只有10多个属性（轻），真实dom是一个对象 有很多属性 （重）。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> vDom <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'p'</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string">'我是p标签'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> vDom1 <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'h2'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    id<span class="token operator">:</span><span class="token string">'shiyue'</span><span class="token punctuation">,</span>
    title<span class="token operator">:</span><span class="token string">'啦啦啦'</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>vDom<span class="token punctuation">)</span>
<span class="token comment">//</span>
<span class="token comment">// //把虚拟dom挂载到真实dom上</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>vDom1<span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// debugger</span>
</code></pre></div><h3 id="_1-1-虚拟dom对比真实dom"><a href="#_1-1-虚拟dom对比真实dom" class="header-anchor">#</a> 1.1 虚拟DOM对比真实DOM</h3> <p><strong>如果没有引入虚拟dom(js对象)</strong></p> <ul><li>数据    var count = 0</li> <li>模板  真实的dom  div</li> <li>真实的dom+数据  --&gt;  div.innerText = count</li> <li>数据变化    count = 2</li> <li>真实的dom + 变化的数据
<ul><li>真实的dom  （真实的dom很重 属性很多）</li> <li>如果对应真实dom的数据变化  那就更新对应的真实dom</li> <li>如果对应真实dom的数据没有变化 那就不更新对应的真实dom</li></ul></li> <li>真实的dom + 变化的数据   div.innerText = count</li></ul> <p><strong>如果有虚拟dom(js对象)</strong></p> <ul><li>数据</li> <li>模板（虚拟dom  用来对应真实的js对象）</li> <li>根据虚拟dom+数据生成真实dom</li> <li>数据变化</li> <li>虚拟dom+变化的数据
<ul><li>虚拟dom  （虚拟的dom很轻 属性很少）  节省了比对的次数 快速比对出差异</li> <li>如果对应虚拟dom的数据变化  那就更新对应的真实dom</li> <li>如果对应虚拟dom的数据没有变化 那就不更新对应的真实dom</li></ul></li> <li>对比</li></ul> <p>在比对虚拟dom的时候 运用了diff（difference）算法</p> <h3 id="_1-2-key值"><a href="#_1-2-key值" class="header-anchor">#</a> 1.2 key值</h3> <p><strong>在列表循环中 没有使用key时。</strong></p> <ul><li>变化后的标签会按照位置顺序使用来变化之前的标签</li></ul> <p>在列表循环中 <strong>使用key时</strong>。</p> <ul><li>变化后的标签会按照key值来使用变化之前的标签</li></ul> <h2 id="_2-jsx语法"><a href="#_2-jsx语法" class="header-anchor">#</a> 2.jsx语法</h2> <p>JavaScript XML，在js中混入html的一种语法。</p> <p><strong>给虚拟dom添加类名  必须是className。</strong></p> <p><strong>给虚拟dom添加事件  必须是on+事件名，并且事件名首字母需要大写。</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token string">'shiyue'</span><span class="token punctuation">,</span>
    b <span class="token operator">=</span> <span class="token string">'十月'</span><span class="token punctuation">,</span>
    c <span class="token operator">=</span> <span class="token string">'我是文本'</span>
<span class="token comment">//创建虚拟dom  jsx  --&gt; javascript XML</span>

<span class="token keyword">function</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> vDom <span class="token operator">=</span> <span class="token operator">&lt;</span>h2 id<span class="token operator">=</span><span class="token punctuation">{</span>a<span class="token punctuation">}</span> className<span class="token operator">=</span><span class="token punctuation">{</span>b<span class="token punctuation">}</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span>fn<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span>c<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>

<span class="token comment">//挂载虚拟dom</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>vDom<span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_3-react组件"><a href="#_3-react组件" class="header-anchor">#</a> 3. React组件</h2> <p>页面是有很多功能模块拼凑而成。</p> <p>每个功能模块内部都有自己的css html 和js。</p> <p>ReactDOM.render函数，可以渲染虚拟dom，也可以渲染组件，渲染组件时，组件的属性名组成的对象（props）会作为实参传递到函数组件中，在组件内部 ，是不可以修改props这个对象的。</p> <p><strong>拆分功能模块就是react中的组件</strong></p> <h3 id="_3-1函数组件"><a href="#_3-1函数组件" class="header-anchor">#</a> 3.1函数组件</h3> <p>函数组件，纯函数，无状态，React16.8版本后开始Hook函数，可以实现函数组件状态。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//定义函数组件</span>
<span class="token keyword">function</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span>我是函数组件（简单组件）<span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">,</span>
    b <span class="token operator">=</span> <span class="token string">'shiyue'</span>

<span class="token comment">//设置Person组件的默认属性</span>
Person<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span><span class="token string">'shiyue'</span><span class="token punctuation">,</span>  <span class="token comment">//当外部已经传递了name属性  就不会生效</span>
    age<span class="token operator">:</span><span class="token number">18</span>
<span class="token punctuation">}</span>
<span class="token comment">//指定Person组件接受的数据类型</span>
Person<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">//id:PropTypes.number,    //接受的id的数据类型必须是number</span>
    name<span class="token operator">:</span>PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>   <span class="token comment">//isRequired  这个属性必须传递</span>
<span class="token punctuation">}</span>
<span class="token comment">//把组件挂载到页面的真实dom中</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Person id<span class="token operator">=</span><span class="token punctuation">{</span>a<span class="token punctuation">}</span> name<span class="token operator">=</span><span class="token string">'外部的name'</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_3-2-类组件"><a href="#_3-2-类组件" class="header-anchor">#</a> 3.2 类组件</h3> <p>类组件有状态，有生命周期函数</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//es6的类组件  这个类组件继承了React.Component这个组件的特性</span>
<span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//在render函数中使用props  必须写成this.props</span>
        <span class="token comment">// console.log(this.props.name)</span>
        <span class="token keyword">return</span> <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span><span class="token function">我是es6类组件</span> <span class="token punctuation">(</span>复杂组件<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

Person<span class="token punctuation">.</span>defaultProps <span class="token operator">=</span> <span class="token punctuation">{</span>
    age<span class="token operator">:</span><span class="token number">18</span>
<span class="token punctuation">}</span>
<span class="token comment">//指定Person组件接受的数据类型</span>
Person<span class="token punctuation">.</span>propTypes <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token comment">//id:PropTypes.number,    //接受的id的数据类型必须是number</span>
    name<span class="token operator">:</span>PropTypes<span class="token punctuation">.</span>string<span class="token punctuation">.</span>isRequired<span class="token punctuation">,</span>   <span class="token comment">//isRequired  这个属性必须传递</span>
<span class="token punctuation">}</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span><span class="token string">'shiyue'</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span><span class="token number">19</span><span class="token punctuation">,</span>
    sex<span class="token operator">:</span><span class="token string">'男'</span>
<span class="token punctuation">}</span>
<span class="token comment">//ReactDOM.render(&lt;Person name={obj.name} age={obj.age} sex={obj.sex}/&gt;,document.getElementById('app'))</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Person <span class="token punctuation">{</span><span class="token operator">...</span>obj<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_4-生命周期函数"><a href="#_4-生命周期函数" class="header-anchor">#</a> 4. 生命周期函数</h2> <p>生命周期函数，简单理解就是指在类组件的某个时刻会自动执行的函数。</p> <h3 id="_4-1-挂载阶段"><a href="#_4-1-挂载阶段" class="header-anchor">#</a> 4.1 挂载阶段</h3> <h4 id="_4-1-1-componentwillmount"><a href="#_4-1-1-componentwillmount" class="header-anchor">#</a> 4.1.1 componentWillMount</h4> <p>当组件将要挂载还没有挂载到真实dom时触发，在整个组件的生命周期中，只能执行一次。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">UNSAFE_componentWillMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Life 组件componentWillMount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_4-1-2-componentdidmount"><a href="#_4-1-2-componentdidmount" class="header-anchor">#</a> 4.1.2 componentDidMount</h4> <p>当组件已经挂载到真实dom时，触发在整个组件的生命周期中，只能执行一次。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">componentDidMount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Life 组件componentDidMount'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-2-更新阶段"><a href="#_4-2-更新阶段" class="header-anchor">#</a> 4.2 更新阶段</h3> <h4 id="_4-2-1-shouldcomponentupdate"><a href="#_4-2-1-shouldcomponentupdate" class="header-anchor">#</a> 4.2.1 shouldComponentUpdate</h4> <p><strong><code>shouldComponentUpdate</code>返回true或false，赋予组件是否更新的权利。</strong></p> <ul><li>父组件渲染  必然导致子组件的渲染</li> <li><code>React.Component</code>这个组件的<code>shouldComponentUpdate</code> <ul><li>默认返回true 即让组件始终更新</li> <li>如不需要组件更新 需要手动判断</li></ul></li> <li><code>React.PureComponent</code>这个组件的<code>shouldComponentUpdate</code> <ul><li>内部对 父组件传递的数据进行判断</li> <li>如果传递的数据没有改变 则返回flase</li> <li>如果传递的数据改变了 则返回true</li></ul></li></ul> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">shouldComponentUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'life 组件 shouldComponentUpdate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_4-2-2-componentwillupdate"><a href="#_4-2-2-componentwillupdate" class="header-anchor">#</a> 4.2.2 componentWillUpdate</h4> <p>当组件的state和props发生变化，触发更新之前，自动触发。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">UNSAFE_componentWillUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'life 组件 componentWillUpdate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_4-2-3-componentdidupdate"><a href="#_4-2-3-componentdidupdate" class="header-anchor">#</a> 4.2.3 componentDidUpdate</h4> <p>组件触发更新，更新结束后触发。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'life 组件 componentDidUpdate'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="_4-2-4-componentwillreceiveprops"><a href="#_4-2-4-componentwillreceiveprops" class="header-anchor">#</a> 4.2.4 componentWillReceiveProps</h4> <p>当组件接受的props改变了之后，就会自动触发。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">UNSAFE_componentWillReceiveProps</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'son 组件componentWillReceiveProps'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-3-组件销毁"><a href="#_4-3-组件销毁" class="header-anchor">#</a> 4.3 组件销毁</h3> <h4 id="_4-3-componentwillunmount"><a href="#_4-3-componentwillunmount" class="header-anchor">#</a> 4.3 componentWillUnmount</h4> <p>组件卸载之前触发。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'组件被卸载了'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-4-render函数"><a href="#_4-4-render函数" class="header-anchor">#</a> 4.4 render函数</h3> <p>初始挂载，<code>setState</code>，依赖数据<code>props</code>数据发生变化 ，在整个组件的生命周期中，可以执行无数次。</p> <h2 id="_5-setstate"><a href="#_5-setstate" class="header-anchor">#</a> 5.setState</h2> <p><strong>setState() 视为---请求---而不是立即更新组件的命令 ;</strong></p> <p>可接收第二个参数，使用时可以传递对象，传递函数，<code>setState</code>可以是同步的，也可以是异步的。</p> <h3 id="_5-1-setstate（）第一个参数"><a href="#_5-1-setstate（）第一个参数" class="header-anchor">#</a> 5.1 setState（）第一个参数</h3> <p><strong>传递对象</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>count<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>传递对象的时候，如果在对象内使用state中的值，即新的值依赖旧的值，<code>state.count</code>值是state中老的值。</p> <p><strong>传递函数</strong></p> <p>​	箭头函数的写法，加上括号，表示返回一个对象。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>count<span class="token operator">:</span>state<span class="token punctuation">.</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><blockquote><p>如果在某一个事件函数内，只有一次setState，那么上述两种写法，表现结果是一样的。</p> <p>如果在某一个事件函数内多次setState（）会把当前函数内多个setState合并成一个，只触发一次render函数。</p></blockquote> <p>看例子：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>Fragment<span class="token punctuation">,</span>Component<span class="token punctuation">}</span> <span class="token operator">=</span> React
<span class="token keyword">class</span> <span class="token class-name">Life</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        count<span class="token operator">:</span><span class="token number">0</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>   <span class="token comment">//在同一个函数中  会把内部的多个setState合并成一个,render()只执行一次     </span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            count<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token operator">+</span><span class="token number">1</span>                    <span class="token comment">//0+1=1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            count<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token operator">+</span><span class="token number">1</span>                    <span class="token comment">//0+1=1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span> count<span class="token operator">:</span>state<span class="token punctuation">.</span>count<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//1+1=2</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span> count<span class="token operator">:</span>state<span class="token punctuation">.</span>count<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//2+1=3</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            count<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token operator">+</span><span class="token number">1</span>                    <span class="token comment">//0+1=1</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span> count<span class="token operator">:</span>state<span class="token punctuation">.</span>count<span class="token operator">+</span><span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//1+1=2</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'render'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>p style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>backgroundColor<span class="token operator">:</span><span class="token string">'pink'</span><span class="token punctuation">}</span><span class="token punctuation">}</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>count<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Life<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>分析：</p> <p>setState在react的事件处理函数和react的生命周期函数中是异步的。</p> <ul><li>第一个setState，拿到的state.count是旧的值0		    count:0+1</li> <li>第一个setState，拿到的state.count还是是旧的值0     count:0+1</li> <li>第三个setState，函数形式，state.count是新值1         count:1+1</li> <li>第四个setState，函数形式，state.count是新值2         count:2+1</li> <li>第五个setState，对象形式，state.count值旧值0         count:0+1</li> <li>第六个setState，函数形式，现在的新值1                     count:1+1</li></ul> <p>这六个stateState()，执行结果count值变为2，触发一次render函数。</p> <h3 id="_5-2-setstate同步异步"><a href="#_5-2-setstate同步异步" class="header-anchor">#</a> 5.2 setState同步异步</h3> <h4 id="_5-2-1-异步的情况"><a href="#_5-2-1-异步的情况" class="header-anchor">#</a> 5.2.1 异步的情况</h4> <p><code>setState</code>在<strong>react的事件处理函数/react的生命周期函数中是异步的</strong>。</p> <p>并且在<code>react</code>事件处理函数/生命周期函数中，会合并多个<code>setState</code>为一个，从而只触发一次<code>render</code>函数，避免render函数高频执行。</p> <h4 id="_5-2-2-同步情况"><a href="#_5-2-2-同步情况" class="header-anchor">#</a> 5.2.2 同步情况</h4> <p><code>setState</code>在<strong>原生的事件处理函数/定时器回调/promise.then的回调中是同步的</strong>，并且不会合并多个<code>setState</code>。</p> <h3 id="_5-3-setstate第二个参数"><a href="#_5-3-setstate第二个参数" class="header-anchor">#</a> 5.3 setState第二个参数</h3> <p><code>setState</code>第二个参数可以传一个回调函数，这个函数的执行时机，在<code>setState</code>执行完毕，并且已经执行了<code>render</code>函数之后立即执行。</p> <h2 id="_6-组建通信传递数据"><a href="#_6-组建通信传递数据" class="header-anchor">#</a> 6. 组建通信传递数据</h2> <h3 id="_6-1-父子组件通信"><a href="#_6-1-父子组件通信" class="header-anchor">#</a> 6.1 父子组件通信</h3> <h4 id="_6-1-1-父传子"><a href="#_6-1-1-父传子" class="header-anchor">#</a> 6.1.1 父传子</h4> <p>通过属性传递数据，并在子组件<code>props</code>拿到父组件传递过来的数据。</p> <h4 id="_6-1-2-父组件拿子组件的数据"><a href="#_6-1-2-父组件拿子组件的数据" class="header-anchor">#</a> 6.1.2 父组件拿子组件的数据</h4> <p>爸爸拿儿子数据，肯定要叫儿子给，并且儿子要有给这个动作，父组件要做事情嘛。</p> <p>1.父组件传递一个函数给子组件。</p> <p>2.在子组件中调用父组件传递的函数，执行该函数时，把数据传递过去。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">Parent</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>
    <span class="token function-variable function">xxx</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">msg</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>我是父组件<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>hr<span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>Son xxx<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>xxx<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">Son</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        msg<span class="token operator">:</span><span class="token string">'我是子组件的数据'</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">sendMsg</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span> <span class="token comment">//这个函数内部 需要把子组件的msg数据 发送给parent组件</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">xxx</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>msg<span class="token punctuation">)</span><span class="token comment">//2.在子组件中调用父组件传递的函数</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>我是子组件<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>sendMsg<span class="token punctuation">}</span><span class="token operator">&gt;</span>点击发送子组件的msg数据<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Parent<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_6-2-任意组建通信"><a href="#_6-2-任意组建通信" class="header-anchor">#</a> 6.2 任意组建通信</h3> <h4 id="_6-2-1-通过仓库"><a href="#_6-2-1-通过仓库" class="header-anchor">#</a> 6.2.1 通过仓库</h4> <h4 id="_6-2-2-pubsub发布订阅"><a href="#_6-2-2-pubsub发布订阅" class="header-anchor">#</a> 6.2.2 pubsub发布订阅</h4> <h5 id="安装依赖"><a href="#安装依赖" class="header-anchor">#</a> 安装依赖</h5> <div class="language-nginx extra-class"><pre class="language-nginx"><code>yarn add <span class="token operator">--</span>save pubsub<span class="token operator">-</span>js
</code></pre></div><p>​	A组件要传递数据给B组件，A发送，B接收。</p> <p>1.在B组件订阅一个事件，事件触发时会执行订阅的回调函数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>PubSub<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>getMsg<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//可在钩子函数componentDidMount中订阅，订阅了xxx事件，一旦触发就执行回调函数            </span>
<span class="token function-variable function">getMsg</span><span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">type<span class="token punctuation">,</span>data</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>type<span class="token punctuation">,</span>data<span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token comment">//type是订阅的事件,data是A传递给B的数据</span>
</code></pre></div><p>2.在A组件中触发B组件订阅的事件，并且传递数据。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>PubSub<span class="token punctuation">.</span><span class="token function">publish</span><span class="token punctuation">(</span><span class="token string">'xxx'</span><span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>msg<span class="token punctuation">)</span>
</code></pre></div><p>需要注意的是，PubSub虽然方便，但是维护时很容易绕晕，发射到哪里，在哪里接收。所以<code>type</code>命名就显得很重要，命名一定要见名知意。可以写<code>fromAtoB</code>,或者传递数据做的事情。</p> <h2 id="_7-受控表单，非受控表单"><a href="#_7-受控表单，非受控表单" class="header-anchor">#</a> 7. 受控表单，非受控表单</h2> <h3 id="_7-1-实时收集数据，受控表单"><a href="#_7-1-实时收集数据，受控表单" class="header-anchor">#</a> 7.1 实时收集数据，受控表单</h3> <p>定义<code>state</code>状态，通过属性的方法绑定给input框value值，给input框绑定onChange事件，input输入时修改<code>state</code>状态。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
            username<span class="token operator">:</span><span class="token string">''</span><span class="token punctuation">,</span>    <span class="token comment">//收集用户输入的用户名    </span>
            psd<span class="token operator">:</span><span class="token string">''</span> 	<span class="token comment">//收集用户输入的密码</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>handleUserChange <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleUserChange</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>handlePsdChange <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handlePsdChange</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">//在input中输入数据的时候,触发onChange事件处理函数</span>
    <span class="token function">handleUserChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            username<span class="token operator">:</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">handlePsdChange</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            psd<span class="token operator">:</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span>username<span class="token punctuation">,</span>psd<span class="token punctuation">}</span> <span class="token operator">=</span>  <span class="token keyword">this</span><span class="token punctuation">.</span>state
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">&quot;/heaven&quot;</span> method<span class="token operator">=</span><span class="token string">&quot;get&quot;</span><span class="token operator">&gt;</span>
                用户：<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> value<span class="token operator">=</span><span class="token punctuation">{</span>username<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleUserChange<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span>
                密码：<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;password&quot;</span> value<span class="token operator">=</span><span class="token punctuation">{</span>psd<span class="token punctuation">}</span> onChange<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>handlePsdChange<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_7-2-需要使用时再取数据，非受控"><a href="#_7-2-需要使用时再取数据，非受控" class="header-anchor">#</a> 7.2 需要使用时再取数据，非受控</h3> <p>非受控表单，不实时收集数据，可以通过React.createRef()打上标记，获取dom节点，就能得到数据。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sex<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">handleSubmit</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//阻止提交按钮默认刷新页面的行为</span>
        <span class="token comment">//获取ref是字符串形式的</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>refs<span class="token punctuation">.</span>username<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token comment">//获取ref是箭头函数形式的</span>
        <span class="token comment">// console.log(this.psd)</span>
        <span class="token comment">//获取ref是对象形式的</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>sex<span class="token punctuation">.</span>current<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>form action<span class="token operator">=</span><span class="token string">&quot;/heaven&quot;</span> method<span class="token operator">=</span><span class="token string">&quot;get&quot;</span><span class="token operator">&gt;</span>
                用户：<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> ref<span class="token operator">=</span><span class="token string">&quot;username&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span>
                密码：<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;password&quot;</span> ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">psd</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>psd<span class="token operator">=</span>psd<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span>
                性别：<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>sex<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;submit&quot;</span> onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleSubmit</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_8-react条件渲染"><a href="#_8-react条件渲染" class="header-anchor">#</a> 8. react条件渲染</h2> <h3 id="三目"><a href="#三目" class="header-anchor">#</a> 三目</h3> <p>三目控制标签的<code>display</code>属性</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token punctuation">{</span>
            isShow<span class="token operator">:</span><span class="token boolean">false</span>    <span class="token comment">//记录显示隐藏  默认false 表示是隐藏的</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token function">handleClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>  <span class="token comment">//点击事件处理函数</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span>isShow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">;</span><span class="token comment">//获取上次的isShow</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            isShow<span class="token operator">:</span><span class="token operator">!</span>isShow
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span>isShow<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>Fragment<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>点击切换<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>display<span class="token operator">:</span>isShow<span class="token operator">?</span><span class="token string">'block'</span><span class="token operator">:</span><span class="token string">'none'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>我是一个div标签<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>Fragment<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_9-react列表渲染"><a href="#_9-react列表渲染" class="header-anchor">#</a> 9. react列表渲染</h2> <p>​	<code>react</code>列表渲染写法非常源生，不像<code>vue</code>，<code>v-for</code>语法糖搞定。</p> <p><code>map</code>遍历数组，生成列表。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> numbers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> listItems <span class="token operator">=</span> numbers<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">number</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token punctuation">{</span>number<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>插入到<code>ul</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>ul<span class="token operator">&gt;</span><span class="token punctuation">{</span>listItems<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_10-react-router-dom路由"><a href="#_10-react-router-dom路由" class="header-anchor">#</a> 10. <code>React-router-dom</code>路由</h2> <h2 id="react前台路由"><a href="#react前台路由" class="header-anchor">#</a> React前台路由</h2> <h3 id="_10-1-react-router-dom包"><a href="#_10-1-react-router-dom包" class="header-anchor">#</a> 10.1 react-router-dom包</h3> <p>路由 : <strong>是一个映射关系</strong></p> <p>后台路由 ：<strong>路径和回调函数构成了映射关系</strong></p> <p>后台路由的特点是</p> <p><strong>1.一定会发起网络请求</strong></p> <p><strong>2.一定会刷新页面</strong></p> <p>前台路由：路径和组件 构成映射关系</p> <p>前台路由的特点是 <strong>实现原理H5的history.pushState 实现的页面应用叫做 SPA Single Page Application</strong></p> <p><strong>1.一定不会发起网络请求</strong></p> <p><strong>2.一定不会刷新页面</strong></p> <h3 id="_10-2-使用"><a href="#_10-2-使用" class="header-anchor">#</a> 10.2 使用</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//引入BrowserRouter在index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>BrowserRouter <span class="token keyword">as</span> Router<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-router-dom'</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>router<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>app<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>app<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//在app.js中配置路由</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>NavLink<span class="token punctuation">,</span>Route<span class="token punctuation">,</span>Switch<span class="token punctuation">,</span>Link<span class="token punctuation">,</span>Redirect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-router-dom'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>
    state <span class="token operator">=</span> <span class="token punctuation">{</span>
        msg<span class="token operator">:</span><span class="token string">'我是app组件的数据'</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>fragment<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>div classname<span class="token operator">=</span><span class="token string">&quot;app-nav-link&quot;</span><span class="token operator">&gt;</span>
 <span class="token comment">//to属性传递对象可携带数据,传递到对应路由渲染的组件，</span>
 <span class="token comment">//在this.props.location.state中得到</span>
                    <span class="token operator">&lt;</span>navlink to<span class="token operator">=</span><span class="token string">&quot;{{&quot;</span> pathname<span class="token operator">:</span><span class="token string">' home'</span><span class="token punctuation">,</span> hash<span class="token operator">:</span><span class="token string">'#aaa'</span><span class="token punctuation">,</span> search<span class="token operator">:</span><span class="token string">'?user=&quot;heaven'</span><span class="token punctuation">,</span><span class="token string">&quot; state:{ msg:this.state.msg } }} activeclassname=&quot;</span>heaven&quot;<span class="token operator">&gt;</span>首页<span class="token operator">&lt;</span><span class="token operator">/</span>navlink<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>navlink to<span class="token operator">=</span><span class="token string">&quot;/user&quot;</span> activeclassname<span class="token operator">=</span><span class="token string">&quot;heaven&quot;</span><span class="token operator">&gt;</span>用户中心<span class="token operator">&lt;</span><span class="token operator">/</span>navlink<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>navlink to<span class="token operator">=</span><span class="token string">&quot;/about&quot;</span> activeclassname<span class="token operator">=</span><span class="token string">&quot;heaven&quot;</span><span class="token operator">&gt;</span>关于我们<span class="token operator">&lt;</span><span class="token operator">/</span>navlink<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>navlink to<span class="token operator">=</span><span class="token string">&quot;/register&quot;</span> activeclassname<span class="token operator">=</span><span class="token string">&quot;heaven&quot;</span><span class="token operator">&gt;</span>注册<span class="token operator">&lt;</span><span class="token operator">/</span>navlink<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>navlink to<span class="token operator">=</span><span class="token string">&quot;/login&quot;</span> activeclassname<span class="token operator">=</span><span class="token string">&quot;heaven&quot;</span><span class="token operator">&gt;</span>登录<span class="token operator">&lt;</span><span class="token operator">/</span>navlink<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token keyword">switch</span><span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>route path<span class="token operator">=</span><span class="token string">&quot;/home&quot;</span> component<span class="token operator">=</span><span class="token string">&quot;{Home}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>route<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>route path<span class="token operator">=</span><span class="token string">&quot;/user&quot;</span> component<span class="token operator">=</span><span class="token string">&quot;{User}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>route<span class="token operator">&gt;</span>
                    <span class="token punctuation">{</span><span class="token comment">/*&lt;route path=&quot;/&quot; component=&quot;{About}&quot;&gt;&lt;/route&gt;*/</span><span class="token punctuation">}</span>
                    <span class="token operator">&lt;</span>route path<span class="token operator">=</span><span class="token string">&quot;/about&quot;</span> component<span class="token operator">=</span><span class="token string">&quot;{About}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>route<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>route path<span class="token operator">=</span><span class="token string">&quot;/register&quot;</span> component<span class="token operator">=</span><span class="token string">&quot;{Register}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>route<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>route path<span class="token operator">=</span><span class="token string">&quot;/login&quot;</span> component<span class="token operator">=</span><span class="token string">&quot;{Login}&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>route<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>redirect to<span class="token operator">=</span><span class="token string">&quot;/home&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>redirect<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span><span class="token keyword">switch</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>fragment<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_10-3-归纳"><a href="#_10-3-归纳" class="header-anchor">#</a> 10.3 归纳</h3> <ul><li><strong>NavLink to属性的默认匹配规则 /home/user（包含匹配或者是模糊匹配）</strong></li> <li><strong>会匹配到Route 的path值是 / /home /home/user的</strong></li> <li><strong>如果需要精确匹配 需要给Route组件加上exact属性</strong></li> <li><strong>如果只需要渲染第一个满足条件的组件 只需要在所有Route组件中加上Switch组件</strong></li> <li><strong>NavLink的to属性 可以是字符串 也可以是对象</strong></li> <li><strong>对象携带数据传递到对应Route渲染的组件，在this.props.location.state获取</strong></li> <li><strong>路径参数存储在this.props.match.params</strong></li> <li><strong>Redirect组件可以实现重定向 一般用来显示默认的组件</strong></li> <li><strong>只要是路由组件 就会有</strong></li> <li><strong>history 存储一个跳转路径的方法</strong></li> <li><strong>location 存放数据</strong></li> <li><strong>match 解析路径得到的数据</strong></li> <li><strong>Link和NavLink的区别：</strong></li> <li><strong>NavLink的标签会自动加上类名active（鼠标点击是才会激活类名） Link不会加类名</strong></li> <li><strong>activeClassName='heaven’可以自定义加什么类名</strong></li></ul> <h3 id="_10-4-编程式导航"><a href="#_10-4-编程式导航" class="header-anchor">#</a> 10.4 编程式导航</h3> <p>通过history的push函数实现页面的跳转 本质上和NavLinK的to属性完全一致</p> <p><strong>push和replace</strong>方法的区别</p> <ul><li>push在原来的历史记录中 叠加</li> <li>replace在原来的历史记录中 替换</li></ul> <p><strong>goBack</strong> 返回历史记录中的后一个路径</p> <p><strong>goForward</strong> 返回历史记录中的前一个路径</p> <div class="language- extra-class"><pre class="language-text"><code>this.props.history.push({
    pathname:`/about/address/${item.pid}`,
    state:{
        pid:item.pid,
        number:item.number
    }
</code></pre></div><h3 id="代码分割-基于路由分割"><a href="#代码分割-基于路由分割" class="header-anchor">#</a> 代码分割,基于路由分割</h3> <p><a href="https://react.docschina.org/docs/code-splitting.html" target="_blank" rel="noopener noreferrer">代码分割官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="_11-redux仓库"><a href="#_11-redux仓库" class="header-anchor">#</a> 11. redux仓库</h2> <p>​	<code>redux</code>并不是<code>react</code>专有的,其他库都能使用。</p> <h3 id="_11-1-redux三个基本原则"><a href="#_11-1-redux三个基本原则" class="header-anchor">#</a> 11.1 redux三个基本原则</h3> <ul><li>整个应用只有唯一一个可信数据源，也就是只有一个 Store。</li> <li>State 只能通过触发 Action 来更改。</li> <li>State 的更改必须写成纯函数，也就是每次更改总是返回一个新的 State。</li></ul> <p>在 Redux 里这种函数称为 Reducer。</p> <h4 id="安装依赖-2"><a href="#安装依赖-2" class="header-anchor">#</a> 安装依赖</h4> <div class="language-nginx extra-class"><pre class="language-nginx"><code>yarn add <span class="token operator">--</span>save redux redux<span class="token operator">-</span>thunk
</code></pre></div><h4 id="目录结构"><a href="#目录结构" class="header-anchor">#</a> 目录结构</h4> <h5 id="_1-store-js"><a href="#_1-store-js" class="header-anchor">#</a> <strong>1. store.js</strong></h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//创建 redux的store  store这个仓库储存了所有组件都可以使用的共有数据</span>
<span class="token comment">//applyMiddleware	如果要使用别的插件,就必须用applyMiddleware包裹</span>
<span class="token comment">//applyMiddleware(thunk)  redux使用thunk这个插件 来拓展redux的功能  异步改变store的数据</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>createStore<span class="token punctuation">,</span>applyMiddleware<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">'redux-thunk'</span>
<span class="token keyword">import</span> reducer <span class="token keyword">from</span> <span class="token string">'./reducer'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span><span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h5 id="_2-reducer-js"><a href="#_2-reducer-js" class="header-anchor">#</a> <strong>2. reducer.js</strong></h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code>定义了一些 根据store的state和action生成新的state
<span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">ADD</span><span class="token punctuation">,</span><span class="token constant">MINUS</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./actions-type'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>action</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// console.log(state,action)</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token constant">ADD</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state<span class="token operator">+</span>action<span class="token punctuation">.</span>data
        <span class="token keyword">case</span> <span class="token constant">MINUS</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state<span class="token operator">-</span>action<span class="token punctuation">.</span>data
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="_3-actions-type-js"><a href="#_3-actions-type-js" class="header-anchor">#</a> <strong>3. actions-type.js</strong></h5> <div class="language-react extra-class"><pre class="language-text"><code>//有可以将action.type值定义为常量使用,减少报错
export const ADD = 'add'
export const MINUS = 'minus'
</code></pre></div><h5 id="_4-actions-js"><a href="#_4-actions-js" class="header-anchor">#</a> <strong>4. actions.js</strong></h5> <p>actions 为了方便组件触发dispatch，普通的dispatch</p> <p>store.dispatch({type:'add',data:value})  ，value是要传递给仓库的数据。</p> <p>当仓库中action动作非常多</p> <p>actions便于管理   store.dispatch(addAction(value))。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//存储改变store中数据的action</span>
<span class="token comment">//同步的动作是一个对象</span>
<span class="token comment">//异步动作需要thunk中间件支持,return一个函数</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">ADD</span><span class="token punctuation">,</span><span class="token constant">MINUS</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./actions-type&quot;</span>
<span class="token comment">//定义增加仓库数据的同步action</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">addAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span><span class="token constant">ADD</span><span class="token punctuation">,</span>data<span class="token operator">:</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//定义减少仓库数据的同步action</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">minusAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span><span class="token constant">MINUS</span><span class="token punctuation">,</span>data<span class="token operator">:</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//定义增加仓库数据的异步action  异步action是一个函数</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">addAsyncAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token parameter">dispatch</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>	<span class="token comment">//dispatch传递进来,2s后触发addAction同步方法</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addAction</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>store</code>暴露出去在入口文件<code>index</code> 传入<code>store</code>。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//入口文件index.js</span>
<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&quot;./redux/store&quot;</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>store<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">//属性传递store,这样传入store只能在App组件使用props.store</span>
<span class="token comment">//ReactDOM.render(&lt;App store={store}/&gt;, document.getElementById('root'));</span>
<span class="token comment">//没有监听仓库,仓库数据改变不会映射到组件</span>

store<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span>render<span class="token punctuation">)</span><span class="token comment">//监听store,一旦仓库数据变化,就会触发subscribe</span>
<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//初始化要执行一次渲染APP</span>
<span class="token keyword">function</span> <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>App store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h5 id="示例："><a href="#示例：" class="header-anchor">#</a> 示例：</h5> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>addAction<span class="token punctuation">,</span>minusAction<span class="token punctuation">,</span>addAsyncAction<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./store/action&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dom <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span>current<span class="token punctuation">.</span>value   <span class="token comment">//value拿到是字符串 转为数字</span>
        <span class="token comment">//触发一个action 同步增加仓库数据</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addAction</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">minus</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span>current<span class="token punctuation">.</span>value   <span class="token comment">//value拿到是字符串 转为数字</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">minusAction</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">addAsync</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span>current<span class="token punctuation">.</span>value
        <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addAsyncAction</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;App&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>section<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>当前store中的Number是<span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>store<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>select ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">}</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">&quot;2&quot;</span><span class="token operator">&gt;</span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">&quot;3&quot;</span><span class="token operator">&gt;</span><span class="token number">3</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>add<span class="token punctuation">}</span><span class="token operator">&gt;</span>增加<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>minus<span class="token punctuation">}</span><span class="token operator">&gt;</span>减少<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addAsync<span class="token punctuation">}</span><span class="token operator">&gt;</span>异步增加<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> App<span class="token punctuation">;</span>
</code></pre></div><p>这样的写法,只是初步实现了<code>redux</code>，通过<code>props</code>取<code>store</code>方法，很麻烦，并且此时的<code>store</code>只能在<code>app</code>组件使用，后续还要传递，并不是注入全局的<code>store</code>。</p> <p><code>react</code>和<code>redux</code>高度耦合了。</p> <h3 id="_11-2-react-redux"><a href="#_11-2-react-redux" class="header-anchor">#</a> 11.2 react-redux</h3> <p><code>react</code>和<code>redux</code>解耦。</p> <h4 id="安装依赖-3"><a href="#安装依赖-3" class="header-anchor">#</a> 安装依赖</h4> <div class="language-javascript extra-class"><pre class="language-javascript"><code>yarn add <span class="token operator">--</span>save redux redux<span class="token operator">-</span>thunk react<span class="token operator">-</span>redux
</code></pre></div><p><code>redux-thunk</code>扩展<code>redux</code>的功能，异步改变store的数据。</p> <h4 id="示例"><a href="#示例" class="header-anchor">#</a> 示例</h4> <p><strong>store.js</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//创建 redux的store  store这个仓库储存了所有组件都可以使用的共有数据</span>
<span class="token comment">//applyMiddleware	如果要使用别的插件,就必须用applyMiddleware包裹</span>
<span class="token comment">//applyMiddleware(thunk)  redux使用thunk这个插件 来拓展redux的功能  异步改变store的数据</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>createStore<span class="token punctuation">,</span>applyMiddleware<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'redux'</span>
<span class="token keyword">import</span> thunk <span class="token keyword">from</span> <span class="token string">'redux-thunk'</span>
<span class="token keyword">import</span> reducer <span class="token keyword">from</span> <span class="token string">'./reducer'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">createStore</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span><span class="token function">applyMiddleware</span><span class="token punctuation">(</span>thunk<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>reducer.js</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>定义了一些 根据store的state和action生成新的state
<span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">ADD</span><span class="token punctuation">,</span><span class="token constant">MINUS</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./actions-type'</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">,</span>action</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">// console.log(state,action)</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token constant">ADD</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state<span class="token operator">+</span>action<span class="token punctuation">.</span>data
        <span class="token keyword">case</span> <span class="token constant">MINUS</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state<span class="token operator">-</span>action<span class="token punctuation">.</span>data
        <span class="token keyword">default</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>actions-type.js</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//有可以将action.type值定义为常量使用,减少报错</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">ADD</span> <span class="token operator">=</span> <span class="token string">'add'</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">MINUS</span> <span class="token operator">=</span> <span class="token string">'minus'</span>
</code></pre></div><p><strong>actions.js</strong></p> <p>actions便于管理   store.dispatch(addAction(value))</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//存储改变store中数据的action</span>
<span class="token comment">//同步的动作是一个对象</span>
<span class="token comment">//异步动作需要thunk中间件支持,return一个函数</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span><span class="token constant">ADD</span><span class="token punctuation">,</span><span class="token constant">MINUS</span><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./actions-type&quot;</span>
<span class="token comment">//定义增加仓库数据的同步action</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">addAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span><span class="token constant">ADD</span><span class="token punctuation">,</span>data<span class="token operator">:</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//定义减少仓库数据的同步action</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">minusAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span><span class="token constant">MINUS</span><span class="token punctuation">,</span>data<span class="token operator">:</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">//定义增加仓库数据的异步action  异步action是一个函数</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">addAsyncAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token parameter">dispatch</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>	<span class="token comment">//dispatch传递进来,2s后触发addAction同步方法</span>
        <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token function">addAction</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">2000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在入口文件index 传入store</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>Provider<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span>
<span class="token comment">//Provider提供;供应的意思;供应器,就不需要subscribe监听了;把最新的store提供给App组件</span>
<span class="token keyword">import</span> store <span class="token keyword">from</span> <span class="token string">&quot;./redux/store&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// store.subscribe(render) //监听store,一旦触发dispatch,重新传入最新的store数据</span>
<span class="token comment">// render()//render初始化</span>
<span class="token comment">// function render() {</span>
<span class="token comment">//     ReactDOM.render(&lt;App store={store}/&gt;, document.getElementById('root'));</span>
<span class="token comment">// }</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>Provider store<span class="token operator">=</span><span class="token punctuation">{</span>store<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>App<span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>Provider<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">,</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>控制台中打印store,上面有store的方法</p> <img src="/docs/images/store控制台.png" alt="store控制台"> <p>App.js</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span><span class="token punctuation">{</span>Component<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>addAction<span class="token punctuation">,</span>minusAction<span class="token punctuation">,</span>addAsyncAction<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./redux/action&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>connect<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react-redux'</span><span class="token punctuation">;</span>
<span class="token comment">//connect 连接;连接器    连接Provider提供的仓库</span>
<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
    <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">super</span><span class="token punctuation">(</span>props<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dom <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createRef</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">add</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span>current<span class="token punctuation">.</span>value<span class="token punctuation">;</span>   <span class="token comment">//value拿到是字符串 转为数字</span>
        <span class="token comment">//触发一个action 同步增加仓库数据</span>
        <span class="token comment">// this.props.store.dispatch(addAction(value))</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">minus</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span>current<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">minus</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function-variable function">addAsync</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> value <span class="token operator">=</span> <span class="token operator">+</span><span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">.</span>current<span class="token punctuation">.</span>value
        <span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span><span class="token function">addAsync</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;App&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>section<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>当前store中的Number是<span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>number<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>select ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>dom<span class="token punctuation">}</span><span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">&quot;1&quot;</span><span class="token operator">&gt;</span><span class="token number">1</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">&quot;2&quot;</span><span class="token operator">&gt;</span><span class="token number">2</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
                        <span class="token operator">&lt;</span>option value<span class="token operator">=</span><span class="token string">&quot;3&quot;</span><span class="token operator">&gt;</span><span class="token number">3</span><span class="token operator">&lt;</span><span class="token operator">/</span>option<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span><span class="token operator">/</span>select<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>add<span class="token punctuation">}</span><span class="token operator">&gt;</span>增加<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>minus<span class="token punctuation">}</span><span class="token operator">&gt;</span>减少<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                    <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>addAsync<span class="token punctuation">}</span><span class="token operator">&gt;</span>异步增加<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// //把state数据映射为App组件的props数据</span>
<span class="token comment">// function mapStateToProps(state){</span>
<span class="token comment">//     return{</span>
<span class="token comment">//         number:state,   //已经做了映射,现在App组件内this.props.number就能拿到数据</span>
<span class="token comment">//     }</span>
<span class="token comment">// }</span>
<span class="token comment">// //把仓库中的dispatch 映射为App组件的props属性</span>
<span class="token comment">// function mapDispatchToProps(dispatch){</span>
<span class="token comment">//     return{</span>
<span class="token comment">//         add:(value)=&gt;dispatch(addAction(value)), </span>
<span class="token comment">//	在组件内this.props.add(value)就能触发修改仓库数据</span>
<span class="token comment">//         minus:(value)=&gt;dispatch(minusAction(value)),</span>
<span class="token comment">//         addAsync:(value)=&gt;dispatch(addAsyncAction(value))</span>
<span class="token comment">//     }</span>
<span class="token comment">// }</span>
<span class="token comment">//connect是个高阶函数,接收两个函数参数,两个函数都返回对象</span>
<span class="token comment">// export default connect(mapStateToProps,mapDispatchToProps)(App)</span>
<span class="token comment">//简写</span>
<span class="token comment">//(state)=&gt;({number:state});箭头函数写法加上() 返回的是对象</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">state</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">(</span><span class="token punctuation">{</span>number<span class="token operator">:</span>state<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token punctuation">{</span>add<span class="token operator">:</span>addAction<span class="token punctuation">,</span>minus<span class="token operator">:</span>minusAction<span class="token punctuation">,</span>addAsync<span class="token operator">:</span>addAsyncAction<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="_12-高阶组件概念"><a href="#_12-高阶组件概念" class="header-anchor">#</a> 12. 高阶组件概念</h2> <p><strong>什么是高阶函数？</strong></p> <p>当一个函数A是接受函数参数B时，则函数A就是高阶函数。数组的<code>sort，map，filter，every，some</code>方法等。</p> <p>当一个函数A返回了函数B时，则函数A就是高阶函数。函数的<code>bind</code>方法。</p> <p><strong>什么是高阶组件？</strong></p> <p>高阶组件是，接受了组件A(基础组件)作为参数，并且返回了一个组件B的函数。</p> <p><strong>高阶组件之属性代理</strong></p> <p>在返回的组件B中定义组件A(基础组件)需要的属性，并且传递给基础组件A。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">App1</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
   <span class="token keyword">return</span> <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span> placeholder<span class="token operator">=</span><span class="token string">&quot;第一个受控组件&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token punctuation">}</span>
<span class="token keyword">class</span> <span class="token class-name">App2</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span><span class="token punctuation">{</span>
   <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
       <span class="token keyword">return</span> <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> <span class="token punctuation">{</span><span class="token operator">...</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">}</span> placeholder<span class="token operator">=</span><span class="token string">&quot;第二个受控组件&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">highOrderComponent</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">BaseComponent</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
   <span class="token comment">//BaseComponent  是函数接受的组件</span>
   <span class="token keyword">return</span> <span class="token keyword">class</span> <span class="token class-name">extends</span> Component<span class="token punctuation">{</span>  <span class="token comment">//返回一个新的组件</span>
       state <span class="token operator">=</span> <span class="token punctuation">{</span>
           value<span class="token operator">:</span><span class="token string">''</span>
       <span class="token punctuation">}</span>
       <span class="token function-variable function">handleChange</span> <span class="token operator">=</span> <span class="token parameter">e</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
           <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>value<span class="token operator">:</span>e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>value<span class="token punctuation">}</span><span class="token punctuation">)</span>
       <span class="token punctuation">}</span>
       <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
           <span class="token keyword">const</span> <span class="token punctuation">{</span>value<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>state
           <span class="token keyword">const</span> newProps <span class="token operator">=</span> <span class="token punctuation">{</span>
               value<span class="token punctuation">,</span>
               onChange<span class="token operator">:</span><span class="token keyword">this</span><span class="token punctuation">.</span>handleChange
           <span class="token punctuation">}</span>
           <span class="token keyword">const</span> props <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>newProps<span class="token punctuation">,</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">)</span>
           <span class="token keyword">return</span> <span class="token operator">&lt;</span>BaseComponent <span class="token punctuation">{</span><span class="token operator">...</span>props<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
       <span class="token punctuation">}</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> Result1 <span class="token operator">=</span> <span class="token function">highOrderComponent</span><span class="token punctuation">(</span>App1<span class="token punctuation">)</span>
<span class="token keyword">const</span> Result2 <span class="token operator">=</span> <span class="token function">highOrderComponent</span><span class="token punctuation">(</span>App2<span class="token punctuation">)</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Result1 a<span class="token operator">=</span><span class="token string">&quot;heaven&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>Result1 b<span class="token operator">=</span><span class="token string">&quot;海文&quot;</span><span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_13-reacthook函数"><a href="#_13-reacthook函数" class="header-anchor">#</a> 13. reacthook函数</h2> <p><a href="https://react.docschina.org/docs/hooks-reference.html" target="_blank" rel="noopener noreferrer">HOOK API索引官方文档地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="概念"><a href="#概念" class="header-anchor">#</a> 概念</h3> <p>hook特性是react<strong>16.8版本</strong>之后才有的新特性，它可以让你在不编写 class 的情况下使用 state 以及其他的 React 特性。</p> <h3 id="_13-1-usestate"><a href="#_13-1-usestate" class="header-anchor">#</a> 13.1 useState</h3> <p><strong>useState这个函数可以让函数组件拥有state(状态)</strong></p> <p>useState(初始值)</p> <ul><li>返回的是长度为2的数组</li> <li>数组第一项括号内的初始值</li> <li>数组第二项是修改该state状态的函数</li></ul> <p>注：初始值只有在第一次执行函数是才有效，之后的每次执行都无效，useState的每次执行是根据初始useState函数的位置。</p> <p><strong>示例</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>useState<span class="token punctuation">}</span> <span class="token operator">=</span> React
<span class="token keyword">function</span> <span class="token function">Heaven</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span>setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行'</span><span class="token punctuation">,</span>count<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>你已经点击了<span class="token punctuation">{</span>count<span class="token punctuation">}</span>次<span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">setCount</span><span class="token punctuation">(</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>点击增加<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h4 id="示例：多组件随机颜色"><a href="#示例：多组件随机颜色" class="header-anchor">#</a> 示例：多组件随机颜色</h4> <p><strong>随机颜色randomColor = '#'+Math.random().toString(16).slice(2,8)</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>useState<span class="token punctuation">}</span> <span class="token operator">=</span> React
<span class="token keyword">function</span> <span class="token function">Heaven1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
	<span class="token keyword">const</span> <span class="token punctuation">[</span>color<span class="token punctuation">,</span>setColor<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span>
	<span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    	<span class="token keyword">const</span> randomColor <span class="token operator">=</span> <span class="token string">'#'</span><span class="token operator">+</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
    	<span class="token function">setColor</span><span class="token punctuation">(</span>randomColor<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token punctuation">(</span>
    	<span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>backgroundColor<span class="token operator">:</span>color<span class="token punctuation">,</span>padding<span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">,</span>textAlign<span class="token operator">:</span><span class="token string">'center'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        	<span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>点击切换颜色<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
    	<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
	<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Heaven2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>color<span class="token punctuation">,</span>setColor<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">// console.log('执行')</span>
        <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token keyword">const</span> randomColor <span class="token operator">=</span> <span class="token string">'#'</span><span class="token operator">+</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
            <span class="token function">setColor</span><span class="token punctuation">(</span>randomColor<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>backgroundColor<span class="token operator">:</span>color<span class="token punctuation">,</span>padding<span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">,</span>textAlign<span class="token operator">:</span><span class="token string">'center'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>点击切换颜色<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Heaven1<span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Heaven2<span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_13-2-useeffect"><a href="#_13-2-useeffect" class="header-anchor">#</a> 13.2 useEffect</h3> <p><strong>useEffect（回调函数,[参数]） 用来模拟es6类组件的生命周期函数，可以在函数组件内执行副作用操作。</strong></p> <ul><li>useEffect第二个参数数组，决定了第二次useEffect函数的是否可以执行。</li> <li>useEffect（回调函数,[]）    等价于  componentDidMount只执行一次.</li> <li>useEffect 回调函数可以返回一个函数，返回的函数模拟componentWillUnmount可以用来清除定时器。</li> <li><strong>可以使用多个useEffect实现关注点分离</strong>。</li></ul> <p><a href="https://react.docschina.org/docs/hooks-effect.html" target="_blank" rel="noopener noreferrer">useEffect更详细见官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><strong>回调函数是当页面渲染render之后 就执行</strong></p> <p>回调函数一般是写副作用代码</p> <p>副作用指的是</p> <p>1.请求数据</p> <p>2.修改原生dom</p> <p>示例</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>useEffect<span class="token punctuation">,</span>useState<span class="token punctuation">}</span> <span class="token operator">=</span> React
<span class="token keyword">function</span> <span class="token function">Heaven</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">[</span>count<span class="token punctuation">,</span>setCount<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        document<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">你已经点击了</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>count<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">次</span><span class="token template-punctuation string">`</span></span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">setCount</span><span class="token punctuation">(</span>count<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>点击<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>useEffect<span class="token punctuation">,</span>useState<span class="token punctuation">}</span> <span class="token operator">=</span> React
<span class="token keyword">function</span> <span class="token function">Heaven</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>color<span class="token punctuation">,</span>setColor<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>number<span class="token punctuation">,</span>setNumber<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'执行'</span><span class="token punctuation">)</span>
        <span class="token keyword">const</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
            <span class="token keyword">const</span> randomColor <span class="token operator">=</span> <span class="token string">'#'</span><span class="token operator">+</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
            <span class="token function">setColor</span><span class="token punctuation">(</span>randomColor<span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>     <span class="token comment">//模拟了componentWillUnmount</span>
            <span class="token comment">// 除了第一次render不执行  其他时候都是在render之后执行</span>
            <span class="token comment">// 执行时间早于useEffect的回调函数</span>
            <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">[</span>number<span class="token punctuation">]</span><span class="token punctuation">)</span>    
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>backgroundColor<span class="token operator">:</span>color<span class="token punctuation">,</span>padding<span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">,</span>textAlign<span class="token operator">:</span><span class="token string">'center'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_13-3-useref"><a href="#_13-3-useref" class="header-anchor">#</a> 13.3 useRef</h3> <p><strong>useRef(参数)</strong> <strong>生成标记对象 {current:标识}</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>useRef<span class="token punctuation">}</span> <span class="token operator">=</span> React
<span class="token keyword">function</span> <span class="token function">Heaven</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> usernameRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> psdRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token string">'psd'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token comment">//得到用户名和密码</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>usernameRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>psdRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>h3<span class="token operator">&gt;</span>非受控表单<span class="token operator">&lt;</span><span class="token operator">/</span>h3<span class="token operator">&gt;</span>
            用户名： <span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;text&quot;</span> ref<span class="token operator">=</span><span class="token punctuation">{</span>usernameRef<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span>
            密码：<span class="token operator">&lt;</span>input type<span class="token operator">=</span><span class="token string">&quot;password&quot;</span> ref<span class="token operator">=</span><span class="token punctuation">{</span>psdRef<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>br<span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>点击发送数据<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_13-4-自定义hook"><a href="#_13-4-自定义hook" class="header-anchor">#</a> 13.4 自定义hook</h3> <p><strong>自定义hook是个函数 一般命名是以use开头</strong> <strong>自定义hook函数的作用是 管理多个组件的公共状态和公共逻辑</strong></p> <p>示例:自定义</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">useRandomColor</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">initColor</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>color<span class="token punctuation">,</span>setColor<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span>initColor<span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleRandom</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">const</span> randomColor <span class="token operator">=</span> <span class="token string">'#'</span><span class="token operator">+</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">)</span>
        <span class="token function">setColor</span><span class="token punctuation">(</span>randomColor<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>color<span class="token punctuation">,</span>handleRandom<span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Heaven1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>color<span class="token punctuation">,</span>handleRandom<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useRandomColor</span><span class="token punctuation">(</span><span class="token string">'red'</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>backgroundColor<span class="token operator">:</span>color<span class="token punctuation">,</span>padding<span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">,</span>textAlign<span class="token operator">:</span><span class="token string">'center'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleRandom<span class="token punctuation">}</span><span class="token operator">&gt;</span>点击切换颜色<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Heaven2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>color<span class="token punctuation">,</span>handleRandom<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useRandomColor</span><span class="token punctuation">(</span><span class="token string">'green'</span><span class="token punctuation">)</span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">setInterval</span><span class="token punctuation">(</span>handleRandom<span class="token punctuation">,</span><span class="token number">1000</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>backgroundColor<span class="token operator">:</span>color<span class="token punctuation">,</span>padding<span class="token operator">:</span><span class="token number">50</span><span class="token punctuation">,</span>textAlign<span class="token operator">:</span><span class="token string">'center'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleClick<span class="token punctuation">}</span><span class="token operator">&gt;</span>点击切换颜色<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Heaven1<span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Heaven2<span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_13-5-usereducer"><a href="#_13-5-usereducer" class="header-anchor">#</a> 13.5 useReducer</h3> <p><strong>构成仓库的必要条件</strong></p> <p><strong>1.初始的数据</strong></p> <p><strong>2.reducer</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>useReducer<span class="token punctuation">}</span> <span class="token operator">=</span> React
<span class="token keyword">const</span> number <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span><span class="token comment">//仓库的初始的数据</span>
<span class="token keyword">const</span> <span class="token function-variable function">reducer</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">state<span class="token punctuation">,</span>action</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>state<span class="token punctuation">,</span> action<span class="token punctuation">)</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>action<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'add'</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state<span class="token operator">+</span>action<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'minus'</span><span class="token operator">:</span>
            <span class="token keyword">return</span> state<span class="token operator">-</span>action<span class="token punctuation">.</span>data<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Heaven</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>state<span class="token punctuation">,</span>dispatch<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useReducer</span><span class="token punctuation">(</span>reducer<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token comment">//传参顺序和解构顺序要区分</span>
    <span class="token keyword">const</span> <span class="token function-variable function">handleAdd</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span><span class="token string">'add'</span><span class="token punctuation">,</span>data<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>p<span class="token operator">&gt;</span>count<span class="token operator">:</span><span class="token punctuation">{</span>state<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>p<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span>handleAdd<span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">+</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>type<span class="token operator">:</span><span class="token string">'minus'</span><span class="token punctuation">,</span>data<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span><span class="token operator">-</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Heaven<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_13-6-usecontext"><a href="#_13-6-usecontext" class="header-anchor">#</a> 13.6 useContext</h3> <p><strong>createContext  创建上下文</strong></p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span>useContext<span class="token punctuation">,</span>useState<span class="token punctuation">,</span>createContext<span class="token punctuation">}</span> <span class="token operator">=</span> React
<span class="token keyword">const</span> Context <span class="token operator">=</span> <span class="token function">createContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">function</span> <span class="token function">Heaven</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">[</span>number<span class="token punctuation">,</span>setNumber<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>Context<span class="token punctuation">.</span>Provider value<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>number<span class="token punctuation">,</span>setNumber<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Son1 <span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>Son2 <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>Context<span class="token punctuation">.</span>Provider<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Son1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>number<span class="token punctuation">,</span>setNumber<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>Context<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">setNumber</span><span class="token punctuation">(</span>number<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>增加<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token function">setNumber</span><span class="token punctuation">(</span>number<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>减少<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">Son2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span>number<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">useContext</span><span class="token punctuation">(</span>Context<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
            组件<span class="token number">2</span><span class="token operator">--</span><span class="token punctuation">{</span>number<span class="token punctuation">}</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>Heaven<span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'box'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_13-7-usecallback"><a href="#_13-7-usecallback" class="header-anchor">#</a> 13.7 useCallback</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> memoizedCallback <span class="token operator">=</span> <span class="token function">useCallback</span><span class="token punctuation">(</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">doSomething</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>a<span class="token punctuation">,</span> b<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>把内联回调函数及依赖项数组作为参数传入 <code>useCallback</code>，它将返回该回调函数的 memoized 版本，该回调函数仅在某个依赖项改变时才会更新。当你把回调函数传递给经过优化的并使用引用相等性去避免非必要渲染（例如 <code>shouldComponentUpdate</code>）的子组件时，它将非常有用。</p> <p><code>useCallback(fn, deps)</code> 相当于 <code>useMemo(() =&gt; fn, deps)</code>。</p> <blockquote><p>注意</p> <p>依赖项数组不会作为参数传给回调函数。虽然从概念上来说它表现为：所有回调函数中引用的值都应该出现在依赖项数组中。未来编译器会更加智能，届时自动创建数组将成为可能。</p> <p>我们推荐启用 <a href="https://www.npmjs.com/package/eslint-plugin-react-hooks#installation" target="_blank" rel="noopener noreferrer"><code>eslint-plugin-react-hooks</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 中的 <a href="https://github.com/facebook/react/issues/14920" target="_blank" rel="noopener noreferrer"><code>exhaustive-deps</code><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 规则。此规则会在添加错误依赖时发出警告并给出修复建议。</p></blockquote> <h2 id="_14-react引用本地图片问题"><a href="#_14-react引用本地图片问题" class="header-anchor">#</a> 14. react引用本地图片问题</h2> <p><strong>react不支持在<code>&lt;img/&gt;</code>标签内直接写图片的路径，即：</strong></p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">&quot;</span>../images/photo.png<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span> 
<span class="token comment">&lt;!--这种写法是不支持的--&gt;</span>
</code></pre></div><h3 id="方法一："><a href="#方法一：" class="header-anchor">#</a> 方法一：</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../img/icon1.png'</span><span class="token punctuation">)</span><span class="token punctuation">}</span> alt<span class="token operator">=</span><span class="token string">&quot;&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><h3 id="方法二："><a href="#方法二：" class="header-anchor">#</a> 方法二：</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> searchURL <span class="token keyword">from</span> <span class="token string">'../img/search.png'</span>
<span class="token keyword">import</span> userURL <span class="token keyword">from</span> <span class="token string">'../img/user.png'</span>
<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>searchURL<span class="token punctuation">}</span> alt<span class="token operator">=</span><span class="token string">&quot;&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>img src<span class="token operator">=</span><span class="token punctuation">{</span>userURL<span class="token punctuation">}</span> alt<span class="token operator">=</span><span class="token string">&quot;&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre></div><h3 id="方法三：-不推荐使用"><a href="#方法三：-不推荐使用" class="header-anchor">#</a> 方法三：(不推荐使用)</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//背景图片引用方法</span>
<span class="token keyword">const</span> divStyle <span class="token operator">=</span> <span class="token punctuation">{</span>
	color<span class="token operator">:</span> <span class="token string">'red'</span><span class="token punctuation">,</span>
	backgroundImage<span class="token operator">:</span> <span class="token string">'url('</span> <span class="token operator">+</span> imgUrl <span class="token operator">+</span> <span class="token string">')'</span><span class="token punctuation">,</span>
<span class="token comment">// 或者 background: url${require(&quot;1.jpg&quot;)}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">function</span> <span class="token function">HelloWorldComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span>divStyle<span class="token punctuation">}</span><span class="token operator">&gt;</span>Hello World<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_15-createreactapp脚手架"><a href="#_15-createreactapp脚手架" class="header-anchor">#</a> 15. CreateReactApp脚手架</h2> <p>react脚手架虽然不像vueCli那样方便，但是任然有入口可以配置。</p> <p>使用<code>customize-cra</code>，<code>react-app-rewired</code>扩展<code>create-react-app</code></p> <h3 id="安装依赖-4"><a href="#安装依赖-4" class="header-anchor">#</a> 安装依赖</h3> <div class="language-nginx extra-class"><pre class="language-nginx"><code>yarn add customize<span class="token operator">-</span>cra react<span class="token operator">-</span>app<span class="token operator">-</span>rewired <span class="token operator">--</span>dev
</code></pre></div><p>在 <code>packages.json</code> 同级目录下创建 <code>config-overrides.js</code> 文件，之后就可以在该文件中扩展相关配置了</p> <p>示例:配置别名:</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token punctuation">{</span> override<span class="token punctuation">,</span>addWebpackAlias <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'customize-cra'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token function">override</span><span class="token punctuation">(</span>
    <span class="token function">addWebpackAlias</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token string">&quot;@style&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src/style&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;@assets&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src/assets&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;@components&quot;</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&quot;src/components&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>更多配置</p> <p><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addwebpackaliasalias" target="_blank" rel="noopener noreferrer">customize-cra插件文档地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 提供的插件。</p> <p>第一次接触这两个插件是在antd按需加载的配置，addLessLoader（{}），神奇操作。原来<code>customize-cra</code>确实是提供了很多功能。</p> <p>慢慢探索吧。</p> <ul><li><code>customizers</code> <ul><li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addtslintloaderloaderoptions" target="_blank" rel="noopener noreferrer">addTslintLoader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addexternalbabelpluginplugin" target="_blank" rel="noopener noreferrer">addExternalBabelPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addexternalbabelpluginsplugins" target="_blank" rel="noopener noreferrer">addExternalBabelPlugins<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addbabelpluginplugin" target="_blank" rel="noopener noreferrer">addBabelPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addbabelpluginsplugins" target="_blank" rel="noopener noreferrer">addBabelPlugins<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addbabelpresetpreset" target="_blank" rel="noopener noreferrer">addBabelPreset<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addbabelpresetspresets" target="_blank" rel="noopener noreferrer">addBabelPresets<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#babelinclude" target="_blank" rel="noopener noreferrer">babelInclude<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#babelexcludeexclude" target="_blank" rel="noopener noreferrer">babelExclude<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#removeinternalbabelpluginpluginname" target="_blank" rel="noopener noreferrer">removeInternalBabelPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#fixbabelimportslibraryname-options" target="_blank" rel="noopener noreferrer">fixBabelImports<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#adddecoratorslegacy" target="_blank" rel="noopener noreferrer">addDecoratorsLegacy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#usebabelrc" target="_blank" rel="noopener noreferrer">useBabelRc<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#disableeslint" target="_blank" rel="noopener noreferrer">disableEsLint<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#useeslintrcconfigfile" target="_blank" rel="noopener noreferrer">useEslintRc<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#enableeslinttypescript" target="_blank" rel="noopener noreferrer">enableEslintTypescript<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addwebpackaliasalias" target="_blank" rel="noopener noreferrer">addWebpackAlias<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addwebpackresolveresolve" target="_blank" rel="noopener noreferrer">addWebpackResolve<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addwebpackpluginplugin" target="_blank" rel="noopener noreferrer">addWebpackPlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addwebpackexternalsdeps" target="_blank" rel="noopener noreferrer">addWebpackExternals<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addwebpackmodulerulerule" target="_blank" rel="noopener noreferrer">addWebpackModuleRule<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#setwebpacktargettarget" target="_blank" rel="noopener noreferrer">setWebpackTarget<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#setwebpackstats" target="_blank" rel="noopener noreferrer">setWebpackStats<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addbundlevisualizeroptions-behindflag--false" target="_blank" rel="noopener noreferrer">addBundleVisualizer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#setwebpackoptimizationsplitchunkstarget" target="_blank" rel="noopener noreferrer">setWebpackOptimizationSplitChunks<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#adjustworkboxfn" target="_blank" rel="noopener noreferrer">adjustWorkbox<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addlessloaderloaderoptions" target="_blank" rel="noopener noreferrer">addLessLoader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#addpostcsspluginsplugins" target="_blank" rel="noopener noreferrer">addPostcssPlugins<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#disablechunk" target="_blank" rel="noopener noreferrer">disableChunk<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#removemodulescopeplugin" target="_blank" rel="noopener noreferrer">removeModuleScopePlugin<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#watchall" target="_blank" rel="noopener noreferrer">watchAll<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#adjustStyleLoaders" target="_blank" rel="noopener noreferrer">adjustStyleLoaders<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li> <li><code>utilities</code> <ul><li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#getbabelloaderconfig-isoutsideofapp" target="_blank" rel="noopener noreferrer">getBabelLoader<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://github.com/arackaf/customize-cra/blob/master/api.md#tapoptions" target="_blank" rel="noopener noreferrer">tap<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></li></ul> <h2 id="_16-代码分割，异步组件"><a href="#_16-代码分割，异步组件" class="header-anchor">#</a> 16. 代码分割，异步组件</h2> <p><a href="https://zh-hans.reactjs.org/docs/code-splitting.html" target="_blank" rel="noopener noreferrer">官方文档地址<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h3 id="_16-1-react-lazy"><a href="#_16-1-react-lazy" class="header-anchor">#</a> 16.1 <code>React.lazy</code></h3> <p><code>React.lazy</code> 函数能让你像渲染常规组件一样处理动态引入（的组件）。</p> <p>使用之前：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> OtherComponent <span class="token keyword">from</span> <span class="token string">'./OtherComponent'</span><span class="token punctuation">;</span>
</code></pre></div><p>使用之后：</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> OtherComponent <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./OtherComponent'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>此代码将会在组件首次渲染时，自动导入包含 <code>OtherComponent</code> 组件的包。</p> <p><code>React.lazy</code> 接受一个函数，这个函数需要动态调用 <code>import()</code><strong>。它必须返回一个 <code>Promise</code>，该<code>Promise</code> 需要 resolve 一个 <code>defalut export</code> 的 <code>React</code> 组件。</strong></p> <p>然后应在 <code>Suspense</code> 组件中渲染 lazy 组件，如此使得我们可以使用在等待加载 lazy 组件时做优雅降级（如 loading 指示器等）.</p> <p>Suspense可包裹多个懒加载组件。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> React<span class="token punctuation">,</span> <span class="token punctuation">{</span> Suspense <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> OtherComponent <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./OtherComponent'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> AnotherComponent <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">lazy</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'./AnotherComponent'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">MyComponent</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>Loading<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>section<span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>OtherComponent <span class="token operator">/</span><span class="token operator">&gt;</span>
          <span class="token operator">&lt;</span>AnotherComponent <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>Suspense<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>注意:</p> <blockquote><p><code>React.lazy</code> 和 <code>Suspense</code> 技术还不支持服务端渲染。如果你想要在使用服务端渲染的应用中使用，我们推荐 <a href="https://github.com/gregberge/loadable-components" target="_blank" rel="noopener noreferrer">Loadable Components<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 这个库。它有一个很棒的<a href="https://loadable-components.com/docs/server-side-rendering/" target="_blank" rel="noopener noreferrer">服务端渲染打包指南<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p></blockquote> <h3 id="_16-2-loading组件封装"><a href="#_16-2-loading组件封装" class="header-anchor">#</a> 16.2 loading组件封装</h3> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> <span class="token string">'@style/loading.scss'</span>
<span class="token keyword">function</span> <span class="token function">Loading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">'loading'</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">&quot;loading_box&quot;</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>span className<span class="token operator">=</span><span class="token string">'load1 item'</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>span className<span class="token operator">=</span><span class="token string">'load2 item'</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>span className<span class="token operator">=</span><span class="token string">'load3 item'</span><span class="token operator">/</span><span class="token operator">&gt;</span>
                <span class="token operator">&lt;</span>span className<span class="token operator">=</span><span class="token string">'load4 item'</span><span class="token operator">/</span><span class="token operator">&gt;</span>
            <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> React<span class="token punctuation">.</span><span class="token function">memo</span><span class="token punctuation">(</span>Loading<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>scss样式：四个小圆点，四角分布，不同透明度，旋转动画。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token comment">/*loading动画;给定位*/</span>
<span class="token atrule"><span class="token rule">@keyframes</span> loading_rotate</span> <span class="token punctuation">{</span>
  <span class="token selector">from</span><span class="token punctuation">{</span>
    <span class="token property">transform</span><span class="token punctuation">:</span><span class="token function">translateX</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span> <span class="token function">rotate</span><span class="token punctuation">(</span>0deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token selector">to</span><span class="token punctuation">{</span>
  <span class="token property">transform</span><span class="token punctuation">:</span><span class="token function">translateX</span><span class="token punctuation">(</span>-50%<span class="token punctuation">)</span> <span class="token function">rotate</span><span class="token punctuation">(</span>360deg<span class="token punctuation">)</span><span class="token punctuation">;</span>
     <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token selector">.loading</span><span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span>100%<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span>fixed<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>255<span class="token punctuation">,</span>255<span class="token punctuation">,</span>255<span class="token punctuation">,</span>.2<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span>100<span class="token selector">;
  .loading_box</span><span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
    <span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span>50%<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span>30%<span class="token punctuation">;</span>
    <span class="token property">animation</span><span class="token punctuation">:</span> loading_rotate .9s linear infinite<span class="token selector">;
    .item</span><span class="token punctuation">{</span>
      <span class="token property">position</span><span class="token punctuation">:</span>absolute<span class="token punctuation">;</span>
      <span class="token property">width</span><span class="token punctuation">:</span>10px<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span>10px<span class="token punctuation">;</span>
      <span class="token property">display</span><span class="token punctuation">:</span>inline-block<span class="token punctuation">;</span>
      <span class="token property">border-radius</span><span class="token punctuation">:</span>50%<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.load1</span><span class="token punctuation">{</span>
      <span class="token property">top</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
      <span class="token property">left</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>24<span class="token punctuation">,</span>144<span class="token punctuation">,</span>255<span class="token punctuation">,</span>.9<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.load2</span><span class="token punctuation">{</span>
      <span class="token property">top</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
      <span class="token property">right</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>24<span class="token punctuation">,</span>144<span class="token punctuation">,</span>255<span class="token punctuation">,</span>.7<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.load3</span><span class="token punctuation">{</span>
      <span class="token property">bottom</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
      <span class="token property">left</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>24<span class="token punctuation">,</span>144<span class="token punctuation">,</span>255<span class="token punctuation">,</span>.5<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.load4</span><span class="token punctuation">{</span>
      <span class="token property">bottom</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
      <span class="token property">right</span><span class="token punctuation">:</span>0<span class="token punctuation">;</span>
      <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token function">rgba</span><span class="token punctuation">(</span>24<span class="token punctuation">,</span>144<span class="token punctuation">,</span>255<span class="token punctuation">,</span>.3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>热歌榜是路由组件，列表是异步请求数据，都使用了React.lazy懒加载，Suspense loading，效果图：</p> <p><img src="/docs/css/loading01.png" alt="loading01" style="width:30%;"> <img src="/docs/css/loading02.png" alt="loading02" style="width:30%;"><img src="/docs/css/loading03.png" alt="loading03" style="width:30%;"></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">2020-5-15 0:34:44</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/docs/assets/js/app.ca99be60.js" defer></script><script src="/docs/assets/js/2.f90869d3.js" defer></script><script src="/docs/assets/js/22.9270e206.js" defer></script>
  </body>
</html>
